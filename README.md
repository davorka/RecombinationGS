# RecombinationGS
This package contains C programs used to perform stability analysis (Jacob.c), frequency based (Recfreq.c) and individually based (IndRec.c) forward-in-time evolutionary simulations of recombination rate between the evolving plasticity and target locus under the genomic storage model, used in Gulisija and Plotkin (Nature Communications, 2017). To run please compile using: 

```
cc -o 'executivename' 'program.c' -lm
```

Brief description of each of the programs follows:

`Jacob.c`

This program produces numerical approximation to the Jacobian matrix for each unique three-locus equilibrium that is polymorphic at both plasticity and target locus (the equilibrium is otherwise not reported), obtained by numerically evolving the selection/recombination recursion given in the manuscript. It requires input files: "trajectory" -- contains three full cycles of “st” variable (see sample ‘trajectory’), and "pars1" -- contains a single 3-number column: PHASE = length of the cycle of fitness oscillations, and the STARTing and ENDing ancestral recombination rate value (freq. = 0.99) which competes with the range of invader rates [0,0.5], given in increments of 0.01. Each search run starts over a range of staring allele frequencies ranging 0.05 to 0.95 in increments of 0.1 at the target locus combined with such range at the plasticity locus, for a given combination of recombination rates. The system evolves until a new unique plasticity -target polymorphic equilibrium is identified, and its Jacobian is numerically approximated. The "output" file reports: settings and the equilibrium values at PHASE, and a sequence of R code which will produce eigenvalues for Jacobean, calculated for three epsilons (10e-10, 10e-11, 10e-12) for cross-reference. Since selection only marginally affects ES rate, stronger selection values are advisable to speed up computation and avoid rounding errors.

`Recfreq.c`

Frequency based forward-in-time simulation.  A ‘rec2new’ recombianation rate is introduced to a monomorphic population of ‘rec2’ rates between the plasticity and the target locus. A recombination modifier locus is recombining with the selected pla-target sequence with the rate ‘rec1’. All three loci receive Np0mu new mutants each generation, with Np0 being the population size. Then population undergoes selection, recombination, and reproduction. Please edit "parameters" section to set above parameters as well as PHASE (length of the oscillating cycle of environmental variation), REPS2 (number of replicate simulations), plas (relative strength of plasticity, 0-1). The TIME is simulation time set at 110N generations such that the ancestral recombination rate is recorded over 10N gens following 100N generations of burnin and at 100N generations to confirm equilibrium. These are reported in the ‘output’ file. This program requires an input file "trajectory" -- contains three full cycles of “st” variable to specify the oscillating selection regime. Sample trajectory file with C (PHASE) = 20 and smax = 0.1 is provided. 

`IndRec.c`

Individually based forward-in-time simulation of evolution of recombination rate between, and of, plasticity and target locus under the genomic storage effect. The population size is defined at 25000, and can be changed in the program. The program requires the ‘pars1’ with a single seed number (please use a positive integer unique for each simulation run), and reports results on a single simulation replicate in a file ‘outfr’. While REPS2 number of replicates parameter can be increased, we advise to run numerous replicates concurrently using different seeds, as these are very computationally costly. This program requires an input file "trajectory" -- contains three full cycles of “st” variable to specify the oscillating selection regime (see sample ‘trajectory’ file). In the program define mu (a mutation rate such that Nmu mutants enters population per generation at each of the three loci), PHASE (the length of the oscillating cycle), and REC (the recombination rate between the rec modifier and the selected pla-target sequence). Plasticity effect is assumed to be 1. A ‘outfr’ file contains a frequencies corresponding to stationary distribution of recombination rates at burning, equilibrium, and a single row at the end of cumulative diversity at the three loci. The frequencies corresponding to stationary distribution are recorded such that 0-50 are bins of rates that fall in [0-0.01>, [0.01,0.02>, etc, during 3 generations at burnin, and 51-101 are bins of frequency of rates falling in [0-0.01>, [0.01,0.02>, etc, over entire 100N generations post burining. 

